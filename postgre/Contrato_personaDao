from contrato_persona import Contrato_persona 
from Conexion import Conexion
from logger_base import log
from cursor_del_pool import CursorDelPool

class Contrato_personaDao:
    _SELECCIONAR = "SELECT * FROM contrato_persona"
    _INSERTAR = "INSERT INTO contrato_persona(id_contrato, id_persona) VALUES (%s,%s)"
    
    @classmethod
    def seleccionar(cls):
       with CursorDelPool() as cursor:
                cursor.execute(cls._SELECCIONAR)
                registros = cursor.fetchall()
                contrato_personas = []
                for r in registros:
                    contrato_persona = Contrato_persona(r[0],r[1])
                    contrato_personas.append(contrato_persona)
                return contrato_personas

    @classmethod
    def insertar(cls, contrato_persona):
        with CursorDelPool() as cursor:
            valores = (contrato_persona.id_contrato, contrato_persona.id_persona)
            cursor.execute(cls._INSERTAR,valores)
            return cursor.rowcount

if __name__ == '__main__':
    #Insertar
    Persona1 = Contrato_persona(id_contrato=1,id_persona=2)
    personasInsertadas = Contrato_personaDao.insertar(Persona1)
    log.debug(f'Contratos persona insertadas {personasInsertadas}')

    Persona1 = Contrato_persona(id_contrato=2,id_persona=3)
    personasInsertadas = Contrato_personaDao.insertar(Persona1)
    log.debug(f'Contratos persona insertadas {personasInsertadas}')

    #ver
    Contrato_persona = Contrato_personaDao.seleccionar()
    for c in Contrato_persona:
        log.debug(c)